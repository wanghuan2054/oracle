# DBLINK 远程调用PROCEDURE  

[toc]

将存储过程的执行权限授权给某用户

GRANT EXECUTE ON PROCEDURENAME(存储过程名称) TO USER（用户名）

### 一. PROCEDURE传参数

#### 1. 源库PROCEDURE操作(ETL库为例)

 ```plsql
BEGIN

  LVV_SQL := 'BEGIN EDBADM.PRC_TABLE_TRUNC@EDB2ETL(:1); END;';

  EXECUTE IMMEDIATE LVV_SQL USING LVV_TABLE1;

 EXCEPTION

  WHEN OTHERS THEN

   DBMS_OUTPUT.PUT_LINE(SQLERRM);

 END;

 DBMS_OUTPUT.PUT_LINE('RESULT' || LVV_RESULT);
 ```

#### 2. 目标库PROCEDURE操作(MDW库为例)

```plsql
CREATE OR REPLACE PROCEDURE PRC_TABLE_TRUNC(LVV_TABLENAME IN VARCHAR2) IS

 LVV_MESSAGE VARCHAR2(1000);

 LVV_SQL   VARCHAR2(1000);

BEGIN

 EXECUTE IMMEDIATE 'TRUNCATE TABLE ' || LVV_TABLENAME || ' REUSE STORAGE';

EXCEPTION

 WHEN OTHERS THEN

  LVV_MESSAGE := LVV_TABLENAME || ' TRUNC ERROR! => ' ||

​          SUBSTR(SQLERRM, 1, 300);

  RAISE_APPLICATION_ERROR(-20200, LVV_MESSAGE);

END;
```

### 二. PROCEDURE不传参数

 ```plsql
 BEGIN

   EDBADM.PRC_EDS_LOT_TRUNC@EDB2ETL;

  END;
 ```

### 三. PROCEDURE调用函数

 ```plsql
 BEGIN

   EDBADM.GET_SHIFT_TIMEKEY@EDB2ETL(T1.EVENT_TIMEKEY)

  END;
 ```

